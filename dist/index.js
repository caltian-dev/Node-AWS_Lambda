"use strict";var jr=Object.create;var re=Object.defineProperty;var Lr=Object.getOwnPropertyDescriptor;var Vr=Object.getOwnPropertyNames;var qr=Object.getPrototypeOf,Gr=Object.prototype.hasOwnProperty;var i=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),At=(t,e)=>{for(var r in e)re(t,r,{get:e[r],enumerable:!0})},Ct=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Vr(e))!Gr.call(t,a)&&a!==r&&re(t,a,{get:()=>e[a],enumerable:!(n=Lr(e,a))||n.enumerable});return t};var It=(t,e,r)=>(r=t!=null?jr(qr(t)):{},Ct(e||!t||!t.__esModule?re(r,"default",{value:t,enumerable:!0}):r,t)),Br=t=>Ct(re({},"__esModule",{value:!0}),t);var ht=i(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne._globalThis=void 0;ne._globalThis=typeof globalThis=="object"?globalThis:global});var xt=i(T=>{"use strict";var Ur=T&&T.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),kr=T&&T.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Ur(e,t,r)};Object.defineProperty(T,"__esModule",{value:!0});kr(ht(),T)});var Dt=i(y=>{"use strict";var Fr=y&&y.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),$r=y&&y.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Fr(e,t,r)};Object.defineProperty(y,"__esModule",{value:!0});$r(xt(),y)});var Ke=i(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.VERSION=void 0;ae.VERSION="1.4.1"});var Lt=i(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.isCompatible=m._makeCompatibilityCheck=void 0;var Kr=Ke(),wt=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function jt(t){let e=new Set([t]),r=new Set,n=t.match(wt);if(!n)return()=>!1;let a={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(a.prerelease!=null)return function(l){return l===t};function s(g){return r.add(g),!1}function u(g){return e.add(g),!0}return function(l){if(e.has(l))return!0;if(r.has(l))return!1;let p=l.match(wt);if(!p)return s(l);let f={major:+p[1],minor:+p[2],patch:+p[3],prerelease:p[4]};return f.prerelease!=null||a.major!==f.major?s(l):a.major===0?a.minor===f.minor&&a.patch<=f.patch?u(l):s(l):a.minor<=f.minor?u(l):s(l)}}m._makeCompatibilityCheck=jt;m.isCompatible=jt(Kr.VERSION)});var S=i(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.unregisterGlobal=P.getGlobal=P.registerGlobal=void 0;var Xr=Dt(),A=Ke(),Wr=Lt(),Yr=A.VERSION.split(".")[0],G=Symbol.for(`opentelemetry.js.api.${Yr}`),B=Xr._globalThis;function Hr(t,e,r,n=!1){var a;let s=B[G]=(a=B[G])!==null&&a!==void 0?a:{version:A.VERSION};if(!n&&s[t]){let u=new Error(`@opentelemetry/api: Attempted duplicate registration of API: ${t}`);return r.error(u.stack||u.message),!1}if(s.version!==A.VERSION){let u=new Error(`@opentelemetry/api: Registration of version v${s.version} for ${t} does not match previously registered API v${A.VERSION}`);return r.error(u.stack||u.message),!1}return s[t]=e,r.debug(`@opentelemetry/api: Registered a global for ${t} v${A.VERSION}.`),!0}P.registerGlobal=Hr;function zr(t){var e,r;let n=(e=B[G])===null||e===void 0?void 0:e.version;if(!(!n||!(0,Wr.isCompatible)(n)))return(r=B[G])===null||r===void 0?void 0:r[t]}P.getGlobal=zr;function Qr(t,e){e.debug(`@opentelemetry/api: Unregistering a global for ${t} v${A.VERSION}.`);let r=B[G];r&&delete r[t]}P.unregisterGlobal=Qr});var Vt=i(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.DiagComponentLogger=void 0;var Jr=S(),Xe=class{constructor(e){this._namespace=e.namespace||"DiagComponentLogger"}debug(...e){return U("debug",this._namespace,e)}error(...e){return U("error",this._namespace,e)}info(...e){return U("info",this._namespace,e)}warn(...e){return U("warn",this._namespace,e)}verbose(...e){return U("verbose",this._namespace,e)}};oe.DiagComponentLogger=Xe;function U(t,e,r){let n=(0,Jr.getGlobal)("diag");if(n)return r.unshift(e),n[t](...r)}});var ie=i(k=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});k.DiagLogLevel=void 0;var Zr;(function(t){t[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"})(Zr=k.DiagLogLevel||(k.DiagLogLevel={}))});var qt=i(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.createLogLevelDiagLogger=void 0;var E=ie();function en(t,e){t<E.DiagLogLevel.NONE?t=E.DiagLogLevel.NONE:t>E.DiagLogLevel.ALL&&(t=E.DiagLogLevel.ALL),e=e||{};function r(n,a){let s=e[n];return typeof s=="function"&&t>=a?s.bind(e):function(){}}return{error:r("error",E.DiagLogLevel.ERROR),warn:r("warn",E.DiagLogLevel.WARN),info:r("info",E.DiagLogLevel.INFO),debug:r("debug",E.DiagLogLevel.DEBUG),verbose:r("verbose",E.DiagLogLevel.VERBOSE)}}se.createLogLevelDiagLogger=en});var R=i(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.DiagAPI=void 0;var tn=Vt(),rn=qt(),Gt=ie(),ce=S(),nn="diag",F=class{constructor(){function e(a){return function(...s){let u=(0,ce.getGlobal)("diag");if(u)return u[a](...s)}}let r=this,n=(a,s={logLevel:Gt.DiagLogLevel.INFO})=>{var u,g,l;if(a===r){let q=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return r.error((u=q.stack)!==null&&u!==void 0?u:q.message),!1}typeof s=="number"&&(s={logLevel:s});let p=(0,ce.getGlobal)("diag"),f=(0,rn.createLogLevelDiagLogger)((g=s.logLevel)!==null&&g!==void 0?g:Gt.DiagLogLevel.INFO,a);if(p&&!s.suppressOverrideMessage){let q=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";p.warn(`Current logger will be overwritten from ${q}`),f.warn(`Current logger will overwrite one already registered from ${q}`)}return(0,ce.registerGlobal)("diag",f,r,!0)};r.setLogger=n,r.disable=()=>{(0,ce.unregisterGlobal)(nn,r)},r.createComponentLogger=a=>new tn.DiagComponentLogger(a),r.verbose=e("verbose"),r.debug=e("debug"),r.info=e("info"),r.warn=e("warn"),r.error=e("error")}static instance(){return this._instance||(this._instance=new F),this._instance}};ue.DiagAPI=F});var Bt=i(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.BaggageImpl=void 0;var N=class{constructor(e){this._entries=e?new Map(e):new Map}getEntry(e){let r=this._entries.get(e);if(r)return Object.assign({},r)}getAllEntries(){return Array.from(this._entries.entries()).map(([e,r])=>[e,r])}setEntry(e,r){let n=new N(this._entries);return n._entries.set(e,r),n}removeEntry(e){let r=new N(this._entries);return r._entries.delete(e),r}removeEntries(...e){let r=new N(this._entries);for(let n of e)r._entries.delete(n);return r}clear(){return new N}};le.BaggageImpl=N});var Ut=i(ge=>{"use strict";Object.defineProperty(ge,"__esModule",{value:!0});ge.baggageEntryMetadataSymbol=void 0;ge.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")});var We=i(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.baggageEntryMetadataFromString=C.createBaggage=void 0;var an=R(),on=Bt(),sn=Ut(),cn=an.DiagAPI.instance();function un(t={}){return new on.BaggageImpl(new Map(Object.entries(t)))}C.createBaggage=un;function ln(t){return typeof t!="string"&&(cn.error(`Cannot create baggage metadata from unknown type: ${typeof t}`),t=""),{__TYPE__:sn.baggageEntryMetadataSymbol,toString(){return t}}}C.baggageEntryMetadataFromString=ln});var $=i(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.ROOT_CONTEXT=h.createContextKey=void 0;function gn(t){return Symbol.for(t)}h.createContextKey=gn;var I=class{constructor(e){let r=this;r._currentContext=e?new Map(e):new Map,r.getValue=n=>r._currentContext.get(n),r.setValue=(n,a)=>{let s=new I(r._currentContext);return s._currentContext.set(n,a),s},r.deleteValue=n=>{let a=new I(r._currentContext);return a._currentContext.delete(n),a}}};h.ROOT_CONTEXT=new I});var kt=i(_e=>{"use strict";Object.defineProperty(_e,"__esModule",{value:!0});_e.DiagConsoleLogger=void 0;var Ye=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],He=class{constructor(){function e(r){return function(...n){if(console){let a=console[r];if(typeof a!="function"&&(a=console.log),typeof a=="function")return a.apply(console,n)}}}for(let r=0;r<Ye.length;r++)this[Ye[r].n]=e(Ye[r].c)}};_e.DiagConsoleLogger=He});var ze=i(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.createNoopMeter=c.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=c.NOOP_OBSERVABLE_GAUGE_METRIC=c.NOOP_OBSERVABLE_COUNTER_METRIC=c.NOOP_UP_DOWN_COUNTER_METRIC=c.NOOP_HISTOGRAM_METRIC=c.NOOP_COUNTER_METRIC=c.NOOP_METER=c.NoopObservableUpDownCounterMetric=c.NoopObservableGaugeMetric=c.NoopObservableCounterMetric=c.NoopObservableMetric=c.NoopHistogramMetric=c.NoopUpDownCounterMetric=c.NoopCounterMetric=c.NoopMetric=c.NoopMeter=void 0;var de=class{constructor(){}createHistogram(e,r){return c.NOOP_HISTOGRAM_METRIC}createCounter(e,r){return c.NOOP_COUNTER_METRIC}createUpDownCounter(e,r){return c.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(e,r){return c.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(e,r){return c.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(e,r){return c.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(e,r){}removeBatchObservableCallback(e){}};c.NoopMeter=de;var x=class{};c.NoopMetric=x;var pe=class extends x{add(e,r){}};c.NoopCounterMetric=pe;var fe=class extends x{add(e,r){}};c.NoopUpDownCounterMetric=fe;var Oe=class extends x{record(e,r){}};c.NoopHistogramMetric=Oe;var D=class{addCallback(e){}removeCallback(e){}};c.NoopObservableMetric=D;var be=class extends D{};c.NoopObservableCounterMetric=be;var ve=class extends D{};c.NoopObservableGaugeMetric=ve;var Ee=class extends D{};c.NoopObservableUpDownCounterMetric=Ee;c.NOOP_METER=new de;c.NOOP_COUNTER_METRIC=new pe;c.NOOP_HISTOGRAM_METRIC=new Oe;c.NOOP_UP_DOWN_COUNTER_METRIC=new fe;c.NOOP_OBSERVABLE_COUNTER_METRIC=new be;c.NOOP_OBSERVABLE_GAUGE_METRIC=new ve;c.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new Ee;function _n(){return c.NOOP_METER}c.createNoopMeter=_n});var Ft=i(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.ValueType=void 0;var dn;(function(t){t[t.INT=0]="INT",t[t.DOUBLE=1]="DOUBLE"})(dn=K.ValueType||(K.ValueType={}))});var Qe=i(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.defaultTextMapSetter=w.defaultTextMapGetter=void 0;w.defaultTextMapGetter={get(t,e){if(t!=null)return t[e]},keys(t){return t==null?[]:Object.keys(t)}};w.defaultTextMapSetter={set(t,e,r){t!=null&&(t[e]=r)}}});var $t=i(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.NoopContextManager=void 0;var pn=$(),Je=class{active(){return pn.ROOT_CONTEXT}with(e,r,n,...a){return r.call(n,...a)}bind(e,r){return r}enable(){return this}disable(){return this}};Pe.NoopContextManager=Je});var W=i(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.ContextAPI=void 0;var fn=$t(),Ze=S(),Kt=R(),et="context",On=new fn.NoopContextManager,X=class{constructor(){}static getInstance(){return this._instance||(this._instance=new X),this._instance}setGlobalContextManager(e){return(0,Ze.registerGlobal)(et,e,Kt.DiagAPI.instance())}active(){return this._getContextManager().active()}with(e,r,n,...a){return this._getContextManager().with(e,r,n,...a)}bind(e,r){return this._getContextManager().bind(e,r)}_getContextManager(){return(0,Ze.getGlobal)(et)||On}disable(){this._getContextManager().disable(),(0,Ze.unregisterGlobal)(et,Kt.DiagAPI.instance())}};Ne.ContextAPI=X});var tt=i(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.TraceFlags=void 0;var bn;(function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"})(bn=Y.TraceFlags||(Y.TraceFlags={}))});var Te=i(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.INVALID_SPAN_CONTEXT=O.INVALID_TRACEID=O.INVALID_SPANID=void 0;var vn=tt();O.INVALID_SPANID="0000000000000000";O.INVALID_TRACEID="00000000000000000000000000000000";O.INVALID_SPAN_CONTEXT={traceId:O.INVALID_TRACEID,spanId:O.INVALID_SPANID,traceFlags:vn.TraceFlags.NONE}});var Se=i(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.NonRecordingSpan=void 0;var En=Te(),rt=class{constructor(e=En.INVALID_SPAN_CONTEXT){this._spanContext=e}spanContext(){return this._spanContext}setAttribute(e,r){return this}setAttributes(e){return this}addEvent(e,r){return this}setStatus(e){return this}updateName(e){return this}end(e){}isRecording(){return!1}recordException(e,r){}};ye.NonRecordingSpan=rt});var ot=i(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.getSpanContext=d.setSpanContext=d.deleteSpan=d.setSpan=d.getActiveSpan=d.getSpan=void 0;var Pn=$(),Nn=Se(),Tn=W(),nt=(0,Pn.createContextKey)("OpenTelemetry Context Key SPAN");function at(t){return t.getValue(nt)||void 0}d.getSpan=at;function yn(){return at(Tn.ContextAPI.getInstance().active())}d.getActiveSpan=yn;function Xt(t,e){return t.setValue(nt,e)}d.setSpan=Xt;function Sn(t){return t.deleteValue(nt)}d.deleteSpan=Sn;function Rn(t,e){return Xt(t,new Nn.NonRecordingSpan(e))}d.setSpanContext=Rn;function Mn(t){var e;return(e=at(t))===null||e===void 0?void 0:e.spanContext()}d.getSpanContext=Mn});var Re=i(b=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.wrapSpanContext=b.isSpanContextValid=b.isValidSpanId=b.isValidTraceId=void 0;var Wt=Te(),mn=Se(),An=/^([0-9a-f]{32})$/i,Cn=/^[0-9a-f]{16}$/i;function Yt(t){return An.test(t)&&t!==Wt.INVALID_TRACEID}b.isValidTraceId=Yt;function Ht(t){return Cn.test(t)&&t!==Wt.INVALID_SPANID}b.isValidSpanId=Ht;function In(t){return Yt(t.traceId)&&Ht(t.spanId)}b.isSpanContextValid=In;function hn(t){return new mn.NonRecordingSpan(t)}b.wrapSpanContext=hn});var ut=i(Me=>{"use strict";Object.defineProperty(Me,"__esModule",{value:!0});Me.NoopTracer=void 0;var xn=W(),zt=ot(),it=Se(),Dn=Re(),st=xn.ContextAPI.getInstance(),ct=class{startSpan(e,r,n=st.active()){if(!!(r!=null&&r.root))return new it.NonRecordingSpan;let s=n&&(0,zt.getSpanContext)(n);return wn(s)&&(0,Dn.isSpanContextValid)(s)?new it.NonRecordingSpan(s):new it.NonRecordingSpan}startActiveSpan(e,r,n,a){let s,u,g;if(arguments.length<2)return;arguments.length===2?g=r:arguments.length===3?(s=r,g=n):(s=r,u=n,g=a);let l=u??st.active(),p=this.startSpan(e,s,l),f=(0,zt.setSpan)(l,p);return st.with(f,g,void 0,p)}};Me.NoopTracer=ct;function wn(t){return typeof t=="object"&&typeof t.spanId=="string"&&typeof t.traceId=="string"&&typeof t.traceFlags=="number"}});var gt=i(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.ProxyTracer=void 0;var jn=ut(),Ln=new jn.NoopTracer,lt=class{constructor(e,r,n,a){this._provider=e,this.name=r,this.version=n,this.options=a}startSpan(e,r,n){return this._getTracer().startSpan(e,r,n)}startActiveSpan(e,r,n,a){let s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)}_getTracer(){if(this._delegate)return this._delegate;let e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):Ln}};me.ProxyTracer=lt});var Qt=i(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.NoopTracerProvider=void 0;var Vn=ut(),_t=class{getTracer(e,r,n){return new Vn.NoopTracer}};Ae.NoopTracerProvider=_t});var pt=i(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.ProxyTracerProvider=void 0;var qn=gt(),Gn=Qt(),Bn=new Gn.NoopTracerProvider,dt=class{getTracer(e,r,n){var a;return(a=this.getDelegateTracer(e,r,n))!==null&&a!==void 0?a:new qn.ProxyTracer(this,e,r,n)}getDelegate(){var e;return(e=this._delegate)!==null&&e!==void 0?e:Bn}setDelegate(e){this._delegate=e}getDelegateTracer(e,r,n){var a;return(a=this._delegate)===null||a===void 0?void 0:a.getTracer(e,r,n)}};Ce.ProxyTracerProvider=dt});var Jt=i(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.SamplingDecision=void 0;var Un;(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Un=H.SamplingDecision||(H.SamplingDecision={}))});var Zt=i(z=>{"use strict";Object.defineProperty(z,"__esModule",{value:!0});z.SpanKind=void 0;var kn;(function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"})(kn=z.SpanKind||(z.SpanKind={}))});var er=i(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.SpanStatusCode=void 0;var Fn;(function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"})(Fn=Q.SpanStatusCode||(Q.SpanStatusCode={}))});var tr=i(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.validateValue=j.validateKey=void 0;var ft="[_0-9a-z-*/]",$n=`[a-z]${ft}{0,255}`,Kn=`[a-z0-9]${ft}{0,240}@[a-z]${ft}{0,13}`,Xn=new RegExp(`^(?:${$n}|${Kn})$`),Wn=/^[ -~]{0,255}[!-~]$/,Yn=/,|=/;function Hn(t){return Xn.test(t)}j.validateKey=Hn;function zn(t){return Wn.test(t)&&!Yn.test(t)}j.validateValue=zn});var ir=i(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.TraceStateImpl=void 0;var rr=tr(),nr=32,Qn=512,ar=",",or="=",J=class{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,r){let n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n}unset(e){let r=this._clone();return r._internalState.delete(e),r}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,r)=>(e.push(r+or+this.get(r)),e),[]).join(ar)}_parse(e){e.length>Qn||(this._internalState=e.split(ar).reverse().reduce((r,n)=>{let a=n.trim(),s=a.indexOf(or);if(s!==-1){let u=a.slice(0,s),g=a.slice(s+1,n.length);(0,rr.validateKey)(u)&&(0,rr.validateValue)(g)&&r.set(u,g)}return r},new Map),this._internalState.size>nr&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,nr))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new J;return e._internalState=new Map(this._internalState),e}};Ie.TraceStateImpl=J});var sr=i(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.createTraceState=void 0;var Jn=ir();function Zn(t){return new Jn.TraceStateImpl(t)}he.createTraceState=Zn});var cr=i(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.context=void 0;var ea=W();xe.context=ea.ContextAPI.getInstance()});var ur=i(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});De.diag=void 0;var ta=R();De.diag=ta.DiagAPI.instance()});var lr=i(L=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});L.NOOP_METER_PROVIDER=L.NoopMeterProvider=void 0;var ra=ze(),we=class{getMeter(e,r,n){return ra.NOOP_METER}};L.NoopMeterProvider=we;L.NOOP_METER_PROVIDER=new we});var _r=i(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.MetricsAPI=void 0;var na=lr(),Ot=S(),gr=R(),bt="metrics",Z=class{constructor(){}static getInstance(){return this._instance||(this._instance=new Z),this._instance}setGlobalMeterProvider(e){return(0,Ot.registerGlobal)(bt,e,gr.DiagAPI.instance())}getMeterProvider(){return(0,Ot.getGlobal)(bt)||na.NOOP_METER_PROVIDER}getMeter(e,r,n){return this.getMeterProvider().getMeter(e,r,n)}disable(){(0,Ot.unregisterGlobal)(bt,gr.DiagAPI.instance())}};je.MetricsAPI=Z});var dr=i(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.metrics=void 0;var aa=_r();Le.metrics=aa.MetricsAPI.getInstance()});var pr=i(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.NoopTextMapPropagator=void 0;var vt=class{inject(e,r){}extract(e,r){return e}fields(){return[]}};Ve.NoopTextMapPropagator=vt});var Or=i(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});v.deleteBaggage=v.setBaggage=v.getActiveBaggage=v.getBaggage=void 0;var oa=W(),ia=$(),Et=(0,ia.createContextKey)("OpenTelemetry Baggage Key");function fr(t){return t.getValue(Et)||void 0}v.getBaggage=fr;function sa(){return fr(oa.ContextAPI.getInstance().active())}v.getActiveBaggage=sa;function ca(t,e){return t.setValue(Et,e)}v.setBaggage=ca;function ua(t){return t.deleteValue(Et)}v.deleteBaggage=ua});var Er=i(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.PropagationAPI=void 0;var Pt=S(),la=pr(),br=Qe(),qe=Or(),ga=We(),vr=R(),Nt="propagation",_a=new la.NoopTextMapPropagator,ee=class{constructor(){this.createBaggage=ga.createBaggage,this.getBaggage=qe.getBaggage,this.getActiveBaggage=qe.getActiveBaggage,this.setBaggage=qe.setBaggage,this.deleteBaggage=qe.deleteBaggage}static getInstance(){return this._instance||(this._instance=new ee),this._instance}setGlobalPropagator(e){return(0,Pt.registerGlobal)(Nt,e,vr.DiagAPI.instance())}inject(e,r,n=br.defaultTextMapSetter){return this._getGlobalPropagator().inject(e,r,n)}extract(e,r,n=br.defaultTextMapGetter){return this._getGlobalPropagator().extract(e,r,n)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,Pt.unregisterGlobal)(Nt,vr.DiagAPI.instance())}_getGlobalPropagator(){return(0,Pt.getGlobal)(Nt)||_a}};Ge.PropagationAPI=ee});var Pr=i(Be=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});Be.propagation=void 0;var da=Er();Be.propagation=da.PropagationAPI.getInstance()});var Sr=i(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.TraceAPI=void 0;var Tt=S(),Nr=pt(),Tr=Re(),V=ot(),yr=R(),yt="trace",te=class{constructor(){this._proxyTracerProvider=new Nr.ProxyTracerProvider,this.wrapSpanContext=Tr.wrapSpanContext,this.isSpanContextValid=Tr.isSpanContextValid,this.deleteSpan=V.deleteSpan,this.getSpan=V.getSpan,this.getActiveSpan=V.getActiveSpan,this.getSpanContext=V.getSpanContext,this.setSpan=V.setSpan,this.setSpanContext=V.setSpanContext}static getInstance(){return this._instance||(this._instance=new te),this._instance}setGlobalTracerProvider(e){let r=(0,Tt.registerGlobal)(yt,this._proxyTracerProvider,yr.DiagAPI.instance());return r&&this._proxyTracerProvider.setDelegate(e),r}getTracerProvider(){return(0,Tt.getGlobal)(yt)||this._proxyTracerProvider}getTracer(e,r){return this.getTracerProvider().getTracer(e,r)}disable(){(0,Tt.unregisterGlobal)(yt,yr.DiagAPI.instance()),this._proxyTracerProvider=new Nr.ProxyTracerProvider}};Ue.TraceAPI=te});var Rr=i(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.trace=void 0;var pa=Sr();ke.trace=pa.TraceAPI.getInstance()});var Mt=i(o=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.trace=o.propagation=o.metrics=o.diag=o.context=o.INVALID_SPAN_CONTEXT=o.INVALID_TRACEID=o.INVALID_SPANID=o.isValidSpanId=o.isValidTraceId=o.isSpanContextValid=o.createTraceState=o.TraceFlags=o.SpanStatusCode=o.SpanKind=o.SamplingDecision=o.ProxyTracerProvider=o.ProxyTracer=o.defaultTextMapSetter=o.defaultTextMapGetter=o.ValueType=o.createNoopMeter=o.DiagLogLevel=o.DiagConsoleLogger=o.ROOT_CONTEXT=o.createContextKey=o.baggageEntryMetadataFromString=void 0;var fa=We();Object.defineProperty(o,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return fa.baggageEntryMetadataFromString}});var Mr=$();Object.defineProperty(o,"createContextKey",{enumerable:!0,get:function(){return Mr.createContextKey}});Object.defineProperty(o,"ROOT_CONTEXT",{enumerable:!0,get:function(){return Mr.ROOT_CONTEXT}});var Oa=kt();Object.defineProperty(o,"DiagConsoleLogger",{enumerable:!0,get:function(){return Oa.DiagConsoleLogger}});var ba=ie();Object.defineProperty(o,"DiagLogLevel",{enumerable:!0,get:function(){return ba.DiagLogLevel}});var va=ze();Object.defineProperty(o,"createNoopMeter",{enumerable:!0,get:function(){return va.createNoopMeter}});var Ea=Ft();Object.defineProperty(o,"ValueType",{enumerable:!0,get:function(){return Ea.ValueType}});var mr=Qe();Object.defineProperty(o,"defaultTextMapGetter",{enumerable:!0,get:function(){return mr.defaultTextMapGetter}});Object.defineProperty(o,"defaultTextMapSetter",{enumerable:!0,get:function(){return mr.defaultTextMapSetter}});var Pa=gt();Object.defineProperty(o,"ProxyTracer",{enumerable:!0,get:function(){return Pa.ProxyTracer}});var Na=pt();Object.defineProperty(o,"ProxyTracerProvider",{enumerable:!0,get:function(){return Na.ProxyTracerProvider}});var Ta=Jt();Object.defineProperty(o,"SamplingDecision",{enumerable:!0,get:function(){return Ta.SamplingDecision}});var ya=Zt();Object.defineProperty(o,"SpanKind",{enumerable:!0,get:function(){return ya.SpanKind}});var Sa=er();Object.defineProperty(o,"SpanStatusCode",{enumerable:!0,get:function(){return Sa.SpanStatusCode}});var Ra=tt();Object.defineProperty(o,"TraceFlags",{enumerable:!0,get:function(){return Ra.TraceFlags}});var Ma=sr();Object.defineProperty(o,"createTraceState",{enumerable:!0,get:function(){return Ma.createTraceState}});var St=Re();Object.defineProperty(o,"isSpanContextValid",{enumerable:!0,get:function(){return St.isSpanContextValid}});Object.defineProperty(o,"isValidTraceId",{enumerable:!0,get:function(){return St.isValidTraceId}});Object.defineProperty(o,"isValidSpanId",{enumerable:!0,get:function(){return St.isValidSpanId}});var Rt=Te();Object.defineProperty(o,"INVALID_SPANID",{enumerable:!0,get:function(){return Rt.INVALID_SPANID}});Object.defineProperty(o,"INVALID_TRACEID",{enumerable:!0,get:function(){return Rt.INVALID_TRACEID}});Object.defineProperty(o,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return Rt.INVALID_SPAN_CONTEXT}});var Ar=cr();Object.defineProperty(o,"context",{enumerable:!0,get:function(){return Ar.context}});var Cr=ur();Object.defineProperty(o,"diag",{enumerable:!0,get:function(){return Cr.diag}});var Ir=dr();Object.defineProperty(o,"metrics",{enumerable:!0,get:function(){return Ir.metrics}});var hr=Pr();Object.defineProperty(o,"propagation",{enumerable:!0,get:function(){return hr.propagation}});var xr=Rr();Object.defineProperty(o,"trace",{enumerable:!0,get:function(){return xr.trace}});o.default={context:Ar.context,diag:Cr.diag,metrics:Ir.metrics,propagation:hr.propagation,trace:xr.trace}});var Ga={};At(Ga,{logger:()=>mt,wrap:()=>wa});module.exports=Br(Ga);var _=It(Mt());function M(t,e="",r={}){if(e&&typeof t=="object"&&t!==null&&Object.keys(t).length===0)return r[e]=Array.isArray(t)?[]:{},r;e=e?`${e}.`:"";for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(typeof t[n]=="object"&&t[n]!==null?M(t[n],e+n,r):r[e+n]=t[n]);return r}var mt={};At(mt,{debug:()=>ha,error:()=>Da,info:()=>Ia,warn:()=>xa});var Fe=It(Mt());var ma=["debug","info","warn","error","fatal"];function $e(t,e,r){if(!Ca(t))return;if(!ma.includes(t))throw new Error(`Invalid log level ${t}`);let n=Fe.trace.getSpan(Fe.context.active());n==null||n.addEvent(e,M(r))}var Aa=process.env.LOG_LEVEL||"INFO";function Ca(t){if(t==="baselime")return!0;let e=["DEBUG","INFO","WARN","ERROR"];return e.indexOf(t.toUpperCase())>=e.indexOf(Aa)}function Dr(t,e){return e?{...t||{},error:{name:e.name,message:e.message,stack:e.stack}}:t}function Ia(t,e){$e("info",t,e||{})}function ha(t,e){$e("warn",t,e||{})}function xa(t,e,r){$e("warn",t,Dr(e||{},r||new Error(t)))}function Da(t,e,r){$e("error",t,Dr(e||{},r||new Error(t)))}function wa(t){return async(e,r)=>{let n=_.trace.getTracer("@baselime/baselime-lambda-wrapper","1"),a=Va(e),s=n.startSpan(r.functionName,{attributes:M({event:e,context:r,faas:{execution:r.awsRequestId,name:r.functionName,runtime:"nodejs",id:r.invokedFunctionArn},cloud:{account:{id:r.invokedFunctionArn.split(":")[4]}}})},a),u=_.trace.setSpan(_.context.active(),s);try{let g=await _.context.with(u,t,null,e,r);return s.setAttributes(M(g,"result")),s.end(),g}catch(g){let l=g;throw s.recordException(l),s.setAttributes(M({name:l.name,message:l.message,stack:l.stack},"error")),s.end(),g}finally{global.baselimeLambdaFlush&&global.baselimeLambdaFlush()}}}function ja(t){var e,r;return(e=t.requestContext)!=null&&e.apiId?"api":t.Records&&((r=t.Records[0])==null?void 0:r.EventSource)==="aws:sns"?"sns":"unknown"}var wr={keys(t){return Object.keys(t)},get(t,e){return t[e]}},La={keys(t){return Object.keys(t)},get(t,e){var r;return(r=t[e])==null?void 0:r.Value}};function Va(t){var n;let e,r=qa(t);return(n=_.trace.getSpan(r))!=null&&n.spanContext()?r:e||_.ROOT_CONTEXT}function qa(t){switch(ja(t)){case"api":let e=t.headers||{};return _.propagation.extract(_.default.context.active(),e,wr);case"sns":return _.propagation.extract(_.default.context.active(),t.Records[0].Sns.MessageAttributes,La)}return _.propagation.extract(_.default.context.active(),{},wr)}0&&(module.exports={logger,wrap});
